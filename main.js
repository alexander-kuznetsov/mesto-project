(()=>{"use strict";var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};function e(t,e,n){e.forEach((function(e){e.validity.valid?function(t,e,n){var o=t.querySelector(".".concat(e.id,"-error"));e.classList.remove(n),o.textContent=""}(t,e,n):function(t,e,n){var o=t.querySelector(".".concat(e.id,"-error"));e.classList.add(n),o.textContent=e.validationMessage}(t,e,n)}))}function n(t,e,n){Array.from(t).some((function(t){return!t.validity.valid}))?(e.disabled=!0,e.classList.add(n)):(e.disabled=!1,e.classList.remove(n))}t.d({},{b7:()=>A,au:()=>D,t1:()=>L,Ag:()=>C});var o="plus-cohort-2",r="755b9008-e161-4a71-9b33-376d2b5a566b";function c(){return fetch("https://nomoreparties.co/v1/".concat(o,"/users/me"),{headers:{authorization:r}}).then((function(t){return t.ok?t.json():Promise.reject("На запрос получения информации о пользователе \n        вернулся ответ со статусом ".concat(t.status,"."))}))}var a=document.querySelector(".popup_type_image"),u=document.querySelector(".popup_type_profile"),i=document.querySelector(".popup_type_card"),s=document.querySelector(".popup_type_avatar"),l=document.querySelectorAll(".popup"),p=document.querySelector("#place-card").content,d=a.querySelector(".popup__image"),f=a.querySelector(".popup__image-caption");function _(t,e){var n=p.cloneNode(!0);return function(t,e,n){var o=t.querySelector(".place__image"),r=t.querySelector(".place"),c=t.querySelector(".button__like");Array.from(e.likes).some((function(t){return t._id===n}))&&c.classList.add("button__like_active"),o.src=e.link,o.alt=e.name,r.id=e._id,t.querySelector(".place__title").textContent=e.name,t.querySelector(".place__like-count").textContent=Array.from(e.likes).length.toString()}(n,t,e),n.querySelector(".button__like").addEventListener("click",(function(e){var n=e.target,c=n.classList.contains("button__like_active")?"DELETE":"PUT";(function(t,e){return fetch("https://nomoreparties.co/v1/".concat(o,"/cards/likes/").concat(t),{method:e,headers:{authorization:r}}).then((function(t){return t.ok?t.json():Promise.reject("На запрос сохранения информации о пользователе \n        вернулся ответ со статусом ".concat(t.status,"."))}))})(t._id,c).then((function(t){var e=t._id;document.querySelector("#".concat(CSS.escape(e))).querySelector(".place__like-count").textContent=Array.from(t.likes).length.toString(),n.classList.toggle("button__like_active")}))})),e!==t.owner._id?n.querySelector(".button__remove").classList.add("button_visible_hidden"):n.querySelector(".button__remove").addEventListener("click",(function(e){var n;(n=t._id,fetch("https://nomoreparties.co/v1/".concat(o,"/cards/").concat(n),{method:"DELETE",headers:{authorization:r}}).then((function(t){if(!t.ok)return Promise.reject("На запрос сохранения информации о пользователе \n        вернулся ответ со статусом ".concat(t.status,"."))}))).then((function(){return e.target.closest(".place").remove()}))})),n.querySelector(".place__image-link").addEventListener("click",(function(e){var n,o;n=t.link,o=t.name,d.src=n,d.alt=o,f.textContent=o,m(a)})),n}fetch("https://nomoreparties.co/v1/".concat(o,"/cards"),{headers:{authorization:r}}).then((function(t){return t.ok?t.json():Promise.reject("На запрос получения карточек вернулся ответ со статусом ".concat(t.status,"."))})).then((function(t){return e=t,void c().then((function(t){Array.from(e).forEach((function(e){D.prepend(_(e,t._id))}))}));var e})).catch((function(t){return console.log(t)}));var v=document.querySelector(".page");function m(t){v.addEventListener("keydown",h),t.classList.add("popup_opened")}function y(t){v.removeEventListener("keydown",h),t.classList.remove("popup_opened")}function h(t){if("Escape"===t.key){var e=(n=l,Array.from(n).find((function(t){return t.classList.contains("popup_opened")})));null!=e&&y(e)}var n}function S(t){t.target.classList.contains("popup")&&y(t.target)}function g(t){Array.from(t).forEach((function(t){return t.value=""}))}function b(t,e){return Array.from(t).find((function(t){return t.name===e}))}function q(t,e){var n=t.querySelector(".button"),o=n.textContent;n.textContent=e?"".concat(o,"..."):o.substring(0,o.length)}var k,E={inputSelector:".popup__input",submitButtonSelector:".button",inactiveButtonClass:"button_state_inactive",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},C=document.querySelector(".profile__title"),L=document.querySelector(".profile__subtitle"),A=document.querySelector(".profile__image"),j=document.querySelector(".profile__image-overlay"),x=u.querySelectorAll(".popup__input"),P=s.querySelector(".popup__input"),T=i.querySelectorAll(".popup__input"),B=document.querySelector(".button__edit"),z=document.querySelectorAll(".button__close"),O=document.querySelector(".button__add"),F=u.querySelector(".button__save"),I=i.querySelector(".button__save"),D=document.querySelector(".places");c().then((function(t){C.textContent=t.name,L.textContent=t.about,A.src=t.avatar})).catch((function(t){return console.log(t)})),u.addEventListener("submit",(function(t){(function(t){t.preventDefault();var e,n,c=t.target.querySelectorAll(".popup__input"),a=b(c,"firstFormInput"),u=b(c,"secondFormInput");q(t.target,!0),(e=a.value,n=u.value,fetch("https://nomoreparties.co/v1/".concat(o,"/users/me"),{method:"PATCH",headers:{authorization:r,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:n})}).then((function(t){return t.ok?t.json():Promise.reject("На запрос сохранения информации о пользователе \n        вернулся ответ со статусом ".concat(t.status,"."))}))).then((function(t){C.textContent=t.name,L.textContent=t.about})).catch((function(t){return console.log(t)})).finally((function(){return q(t.target,!1)}))})(t),y(u)})),i.addEventListener("submit",(function(t){(function(t){t.preventDefault();var e,n,a=t.target.querySelectorAll(".popup__input"),u=b(a,"firstFormInput"),i=b(a,"secondFormInput");q(t.target,!0),(e=u.value,n=i.value,fetch("https://nomoreparties.co/v1/".concat(o,"/cards"),{method:"POST",headers:{authorization:r,"Content-Type":"application/json"},body:JSON.stringify({name:e,link:n})}).then((function(t){return t.ok?t.json():Promise.reject("На запрос сохранения информации о пользователе \n        вернулся ответ со статусом ".concat(t.status,"."))}))).then((function(t){c().then((function(e){D.prepend(_(t,e._id))})).catch((function(t){return console.log(t)}))})).catch((function(t){return console.log(t)})).finally((function(){return q(t.target,!1)})),g(a)})(t),y(i)})),s.addEventListener("submit",(function(t){(function(t){t.preventDefault();var e,n=t.target.querySelector(".popup__input");q(t.target,!0),(e=n.value,fetch("https://nomoreparties.co/v1/".concat(o,"/users/me/avatar"),{method:"PATCH",headers:{authorization:r,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((function(t){if(!t.ok)return Promise.reject("На запрос сохранения аватарки вернулся ответ со статусом ".concat(t.status,"."))}))).catch((function(t){return console.log(t)})).finally((function(){return q(t.target,!1)})),A.src=n.value,g([n])})(t),y(s)})),B.addEventListener("click",(function(t){var o=b(x,"firstFormInput"),r=b(x,"secondFormInput");o.value=C.textContent,r.value=L.textContent,e(u,x,E.inputErrorClass),n([o,r],F,E.inactiveButtonClass),m(u)})),z.forEach((function(t){t.addEventListener("click",(function(t){y(t.target.closest(".popup"))}))})),O.addEventListener("click",(function(t){n(T,I,E.inactiveButtonClass),m(i)})),j.addEventListener("click",(function(t){n([P],I,E.inactiveButtonClass),m(s)})),l.forEach((function(t){t.addEventListener("click",S)})),k=E,Array.from(document.forms).forEach((function(t){var o=Array.from(t.querySelectorAll(k.inputSelector)),r=t.querySelector(k.submitButtonSelector);n(o,r,k.inactiveButtonClass),o.forEach((function(c){c.addEventListener("input",(function(a){e(t,[c],k.inputErrorClass),n(o,r,k.inactiveButtonClass)}))}))}))})();